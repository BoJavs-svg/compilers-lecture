# Lex and Yacc: Simple Calculator Example

## Introduction
Lex and Yacc are powerful tools used to generate lexical analyzers (scanners) and parsers. In this guide, we will create a simple calculator using Lex (Flex) and Yacc (Bison) that can evaluate expressions with addition, subtraction, multiplication, and variable assignment.

## Prerequisites
Ensure you have `flex` and `bison` installed:

### On Linux/macOS:
```sh
sudo apt install flex bison   # Ubuntu/Debian
sudo pacman -S flex bison     # Arch Linux
brew install flex bison       # macOS (Homebrew)
```

### On Windows:
Use MinGW or Cygwin to install `flex` and `bison`.

## Understanding Lex and Yacc Internal Functions
Lex and Yacc use several internal functions that play key roles in lexical analysis and parsing:

- **`yyparse()`**: This function is automatically generated by Yacc (Bison). It drives the parsing process by calling `yylex()` to fetch tokens and applying grammar rules.
- **`yylex()`**: This function is generated by Lex (Flex). It scans the input text and returns tokens to the parser. It is responsible for pattern matching based on the rules defined in the `.l` file.
- **`yyerror(const char *s)`**: This function is called by `yyparse()` whenever a syntax error occurs. It prints an error message, allowing debugging of incorrect input.

## Writing the Lex Scanner
Create a file named `scanner.l` with the following content:

```c
%{
#include "y.tab.h"
#include <stdlib.h>
extern int yylval;
%}

%option noyywrap

%%
[0-9]+      { yylval = atoi(yytext); return NUMBER; }
[a-z]       { yylval = yytext[0]; return NAME; }
[ \t]       ; /* Ignore whitespace */
\n          return 0; /* Logical EOF */
.           return yytext[0];
%%
```

## Writing the Yacc Parser
Create a file named `parser.y`:

```c
%{
#include <stdio.h>
int yylex();
void yyerror (char const *s) {
    fprintf (stderr, "%s\n", s);
}
%}

%token NAME NUMBER

%%

statement: NAME '=' expression  { printf("%c = %d\n", $1, $3); }
         | expression           { printf("= %d\n", $1); }
         ;

expression: expression '+' NUMBER { $$ = $1 + $3; }
          | expression '-' NUMBER { $$ = $1 - $3; }
          | expression '*' NUMBER { $$ = $1 * $3; }
          | '(' expression ')'    { $$ = $2; }
          | NUMBER                { $$ = $1; }
          ;

%%

int main() {
    yyparse();
    return 0;
}
```

## Compiling and Running the Calculator
Run the following commands:

```sh
flex scanner.l
bison -d parser.y
gcc lex.yy.c parser.tab.c -o calculator -lm
./calculator
```

### Example Input/Output:
```
x = 3 + 5
x = 8
5 * 2
= 10
```

## Extending the Calculator
- Add division (`/` operator)
- Implement variable storage
- Support floating-point numbers

This guide provides a basic starting point for learning Lex and Yacc. Experiment and extend it to build more complex parsers!

